<center><div class="panel panel-default">
  <%= form_for @note do |f| %>
    <div class="panel-body">
      <h4>
        <%= f.label :text %><br>
        <%= f.text_area :text %>
      </h4>

      <select id='note_type' name='note_type' onchange='create_second_select();'>
          <option value='1'>General</option>
          <option value='2'>Project</option>
          <option value='3'>Task</option>
          <option value='4'>User</option>
      </select>

    </div>

    <div class="panel-footer clearfix ">
      <button type="submit" class="btn btn-lg btn-primary btn-block">
        <i class="glyphicon glyphicon-save"></i> Save
      </button>
    </div>
  <% end %>

 <% if @note.errors.any? %>
    <div id="error_explanation">
      <h4>
        <%= pluralize(@note.errors.count, "error") %> prohibited
        this note from being saved:
      </h4>
      <ul>
        <% @note.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
</div>

<script type="text/javascript">
  function create_second_select(){
    var type = document.getElementById('note_type').value;
    var id;
    var name;
    switch(type){
        case '2':
          id = '<%= @projects.collect{|p| p.id} %>';
          name = '<%= @projects.collect{|p| p.title} %>';
        break;
        case '3':
          id = '<%= @tasks.collect{|t| t.id} %>';
          name = '<%= @tasks.collect{|t| t.title} %>';
        break;
        case '4':
          id = '<%= @users.collect{|u| u.id} %>';
          name = '<%= @users.collect{|u| u.username} %>';
        break;
    }
    
  }
</script>